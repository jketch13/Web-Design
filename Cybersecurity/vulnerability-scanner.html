const net = require('net');

function checkPort(host, port, timeout = 3000) {
return new Promise((resolve, reject) => {
const socket = new net.Socket();

socket.setTimeout(timeout);
socket.on('connect', () => {
socket.destroy();
resolve({ port, open: true });
});

socket.on('timeout', () => {
socket.destroy();
resolve({ port, open: false });
});

socket.on('error', () => {
resolve({ port, open: false });
});

socket.connect(port, host);
});
}

async function scanPorts(host, startPort = 1, endPort = 65535) {
const results = [];
for (let port = startPort; port <= endPort; port++) {
const result = await checkPort(host, port);
if (result.open) {
console.log(`Port ${port} is open`);
}
results.push(result);
}
return results;
}

// Example usage: Scan localhost
scanPorts('127.0.0.1', 1, 1024).then(results => {
console.log('Scan complete');
console.log(results);
});
